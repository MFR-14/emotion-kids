<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GESYA - Cara Bermain</title>
  <link rel="stylesheet" href="./css/menu.css?v=4">
</head>

<body class="home">

  <!-- =========================
       PIN / PASSWORD OVERLAY
       ========================= -->
  <div id="pinOverlay" class="pin-overlay">
    <div class="pin-card">
      <h2 class="pin-title">ğŸ” Akses GESYA</h2>

      <!-- âœ… INTRO SEBELUM INPUT PIN -->
      <div class="pin-intro">
        <div class="pin-intro-title">Hai, selamat datang di GESYA! ğŸŒŸ</div>
        <div class="pin-intro-text">
          Game GESYA ini ditujukan bagi anak dengan disleksia usia <b>9â€“12 tahun</b> sebagai media pembelajaran
          untuk membantu anak mengenali emosi yang mereka rasakan serta melatih keterampilan mengelola emosi
          secara tepat dalam kehidupan sehari-hari.
        </div>
        <div class="pin-intro-tip">Kalau sudah siap, minta PIN ke guru ya ğŸ˜Š</div>
      </div>

      <p class="pin-desc">Masukkan PIN dari guru / admin</p>

      <input
        id="pinInput"
        class="pin-input"
        type="password"
        inputmode="numeric"
        placeholder="â€¢â€¢â€¢â€¢"
        autocomplete="off"
      />

      <button id="btnPin" class="pin-btn" type="button">Masuk</button>

      <p id="pinError" class="pin-error">PIN salah. Coba lagi ya ğŸ™‚</p>

      <div class="pin-footer">
        Tips: kalau sudah masuk, PIN tidak diminta lagi di perangkat ini.
      </div>
    </div>
  </div>

  <main class="wrap">

    <!-- GAMBAR ATAS -->
    <section class="hero">
      <img src="./img/12.jpg" class="mascot" alt="Maskot GESYA">
      <div class="hero-title">
        <h1>Cara Bermain Game GESYA</h1>
        <p>Yuk main sambil belajar mengenali emosi ğŸ˜Š</p>
      </div>
    </section>

    <!-- PERATURAN -->
    <section class="card rules-card">
      <h2>Aturannya Mudah!</h2>
      <ul class="rules">
        <li>âœ… Cocokkan emosi sesuai level yang tersedia</li>
        <li>âœ… Klik atau geser jawaban sesuai pertanyaan</li>
        <li>âœ… Main sesuai waktu yang disediakan</li>
        <li>âœ… Setiap level ada nilai bintang â­</li>
        <li>âœ… Selesaikan semua level untuk dapat lencana <b>Ahli Emosi GESYA</b></li>
      </ul>
    </section>

    <!-- LEVEL -->
    <section class="card level-card">
      <h2>Pilih Level</h2>

      <div class="levels">
        <button class="lvl" onclick="goLevel(1)">
          <span class="no">1</span>
          <span class="txt">Level 1<br><small>Kenali Emosi</small></span>
          <span class="emo">ğŸ¯</span>
        </button>

        <button class="lvl" onclick="goLevel(2)">
          <span class="no">2</span>
          <span class="txt">Level 2<br><small>Pasangkan</small></span>
          <span class="emo">ğŸ§©</span>
        </button>

        <button class="lvl" onclick="goLevel(3)">
          <span class="no">3</span>
          <span class="txt">Level 3<br><small>Tempel Wajah</small></span>
          <span class="emo">ğŸ™‚</span>
        </button>

        <button class="lvl" onclick="goLevel(4)">
          <span class="no">4</span>
          <span class="txt">Level 4<br><small>Perasaanku</small></span>
          <span class="emo">ğŸ˜</span>
        </button>

        <button class="lvl" onclick="goLevel(5)">
          <span class="no">5</span>
          <span class="txt">Level 5<br><small>Aku Pilih Apa?</small></span>
          <span class="emo">ğŸ™‹â€â™‚ï¸</span>
        </button>

        <button class="lvl" onclick="goLevel(6)">
          <span class="no">6</span>
          <span class="txt">Level 6<br><small>Situasi</small></span>
          <span class="emo">ğŸ”¥</span>
        </button>

        <!-- âœ… MENU SERTIFIKAT (TERKUNCI SAMPAI 6 LEVEL SELESAI) -->
        <button class="lvl" id="btnReward" onclick="goReward()" disabled style="opacity:.55">
          <span class="no">ğŸ…</span>
          <span class="txt">Pencapaian<br><small>Sertifikat</small></span>
          <span class="emo">ğŸ“œ</span>
        </button>
      </div>

      <div class="bottom-note" id="progressNote">Tips: isi nama, umur, dan sekolah di Level 1 dulu ya âœ¨</div>

      <button class="reset" id="btnReset" type="button">Reset Data</button>
    </section>

  </main>

  <script>
    // =====================
    // KONFIG PIN
    // =====================
    const PIN_BENAR = "2025"; // â¬…ï¸ GANTI PIN DI SINI
    const KEY_UNLOCK = "gesya_unlocked";

    const overlay = document.getElementById("pinOverlay");
    const input   = document.getElementById("pinInput");
    const btn     = document.getElementById("btnPin");
    const err     = document.getElementById("pinError");

    function openAccess(){
      localStorage.setItem(KEY_UNLOCK, "1");
      overlay.style.display = "none";
    }

    function cekPin(){
      const val = (input.value || "").trim();
      if (val === PIN_BENAR) {
        err.style.display = "none";
        openAccess();
      } else {
        err.style.display = "block";
        input.value = "";
        input.focus();
      }
    }

    // kalau sudah pernah lolos, langsung masuk
    if (localStorage.getItem(KEY_UNLOCK) === "1") {
      overlay.style.display = "none";
    } else {
      setTimeout(()=> input && input.focus(), 200);
    }

    btn.addEventListener("click", cekPin);
    input.addEventListener("keydown", (e)=>{
      if (e.key === "Enter") cekPin();
    });

    // =====================
    // MENU GAME
    // =====================
    function goLevel(lvl){
      // kunci level 7 dulu biar anak gak bingung
      if (lvl >= 7) {
        alert("Level ini masih dikunci ya ğŸ˜„");
        return;
      }
      window.location.href = `level${lvl}.html`;
    }

    function isAllLevelDone(){
      for (let i = 1; i <= 6; i++){
        const done = localStorage.getItem(`ek_level${i}_selesai`);
        if (done !== "1") return false;
      }
      return true;
    }

    function goReward(){
      if (!isAllLevelDone()){
        alert("Selesaikan dulu sampai Level 6 ya, baru sertifikatnya kebuka ğŸ˜");
        return;
      }
      window.location.href = "reward.html";
    }

    // ======= PROGRES / IDENTITAS =======
    const s1 = parseInt(localStorage.getItem("ek_level1_skor") || "0", 10);
    const s2 = parseInt(localStorage.getItem("ek_level2_skor") || "0", 10);
    const s3 = parseInt(localStorage.getItem("ek_level3_skor") || "0", 10);
    const s4 = parseInt(localStorage.getItem("ek_level4_skor") || "0", 10);
    const s5 = parseInt(localStorage.getItem("ek_level5_skor") || "0", 10);
    const s6 = parseInt(localStorage.getItem("ek_level6_skor") || "0", 10);
    const total = s1 + s2 + s3 + s4 + s5 + s6;

    const nama = (localStorage.getItem("ek_nama") || "").trim();
    const umur = (localStorage.getItem("ek_umur") || "").trim();
    const sekolah = (localStorage.getItem("ek_sekolah") || "").trim();

    const note = document.getElementById("progressNote");

    // tampilkan note kalau sudah pernah isi data atau sudah ada skor
    if (nama || umur || sekolah || total) {
      const namaTampil = nama ? nama.toUpperCase() : "TEMAN";
      const umurTampil = umur ? `${umur} tahun` : "-";
      const sekolahTampil = sekolah || "-";
      note.textContent = `Halo ${namaTampil}! Umur ${umurTampil} â€¢ Sekolah ${sekolahTampil} â€¢ Skor sementara ${total} â­`;
    }

    // âœ… AKTIFKAN TOMBOL SERTIFIKAT KALAU SUDAH SELESAI LEVEL 1-6
    const btnReward = document.getElementById("btnReward");
    if (btnReward){
      if (isAllLevelDone()){
        btnReward.disabled = false;
        btnReward.style.opacity = "1";
      } else {
        btnReward.disabled = true;
        btnReward.style.opacity = ".55";
      }
    }

    // ======= RESET =======
    document.getElementById("btnReset").addEventListener("click", ()=>{
      if (!confirm("Reset nama, umur, sekolah, dan semua skor?")) return;

      // identitas
      localStorage.removeItem("ek_nama");
      localStorage.removeItem("ek_umur");
      localStorage.removeItem("ek_sekolah");

      // skor & status level
      const keys = [
        "ek_level1_skor","ek_level2_skor","ek_level3_skor","ek_level4_skor","ek_level5_skor","ek_level6_skor",
        "ek_level1_selesai","ek_level2_selesai","ek_level3_selesai","ek_level4_selesai","ek_level5_selesai","ek_level6_selesai",
        "ek_level1_alasan","ek_level2_alasan","ek_level3_alasan","ek_level4_alasan","ek_level5_alasan","ek_level6_alasan"
      ];
      keys.forEach(k => localStorage.removeItem(k));

      // reset PIN biar kalau perangkat dipakai orang lain, minta PIN lagi
      localStorage.removeItem(KEY_UNLOCK);

      location.reload();
    });
  </script>

</body>
</html>
